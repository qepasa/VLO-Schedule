(this["webpackJsonpvlo-schedule"]=this["webpackJsonpvlo-schedule"]||[]).push([[0],{116:function(e,t,n){},123:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"loadScheduleEpic",(function(){return fe}));var c={};n.r(c),n.d(c,"getSchedule",(function(){return ve}));var a=n(2),s=n(0),o=n.n(s),i=n(14),l=n.n(i),d=(n(116),n(44)),j=n(13),u=n(142),b=n(143),h=n(58),O=Object(u.a)((function(e){return{toolbar:{borderBottom:"1px solid ".concat(e.palette.divider)},toolbarTitle:{margin:e.spacing(1),flex:1}}})),p=function(){var e=O(),t=Object(j.f)().classParam;return Object(a.jsx)(b.a,{className:e.toolbar,children:Object(a.jsxs)(h.a,{component:"h2",variant:"h5",color:"inherit",align:"center",noWrap:!0,className:e.toolbarTitle,children:["Rozk\u0142ad klasy ",t]})})},f=n(164),x=n(154),v=n(155),m=n(156),g=n(79),y=n(43),S=Object(y.createAsyncAction)("LOAD_SCHEDULE_REQUEST","LOAD_SCHEDULE_SUCCESS","LOAD_SCHEDULE_FAILURE")(),w=n(83),A=n(57),C=n(162);function k(e,t){return t>e?k(t,e):0==t?e:k(t,e%t)}function _(e){if(0==e.length)throw Error("You need to pass at least one number!");if(1==e.length)return e[0];if(2==e.length)return e[0]*e[1]/k(e[0],e[1]);var t=e.pop(),n=_(e);return t*n/k(t,n)}var D=n(84),E=n(97),T=n.n(E),B=n(145),I=n(163),R=n(146),F=n(147),L=n(148),W=n(167),G=n(149),N=n(150),H=n(151),M=n(152),P=function(e){var t=e.lessons,n=e.lessonNumber,r=e.onClose,c=e.open,s=function(){r()};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(B.a,{}),Object(a.jsxs)(I.a,{onClose:s,"aria-labelledby":"lessons-list-dialog",open:c,fullWidth:!0,children:[Object(a.jsxs)(R.a,{id:"lessons-list-dialog-title",children:["Lekcja ",n]}),Object(a.jsx)(F.a,{children:Object(a.jsx)(L.a,{children:t.map((function(e){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(W.a,{children:Object(a.jsx)(G.a,{primary:"Nazwa lekcji: ".concat(e.subject),secondary:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:["Nauczyciel: ",e.teacher]}),Object(a.jsxs)("div",{children:["Sala: ",e.classroom]})]})})},e.subject+e.teacher+e.color),Object(a.jsx)(N.a,{variant:"inset",component:"li"})]})}))})}),Object(a.jsx)(H.a,{children:Object(a.jsx)(M.a,{onClick:s,color:"primary",children:"Zamknij"})})]})]})},U=function(e){var t=e.lesson,n=e.height,r=e.lessonsByHour,c=T()(),o=c.fontSize,i=c.ref,l=Object(s.useState)(!1),d=Object(D.a)(l,2),j=d[0],u=d[1],b=Object(s.useState)([]),h=Object(D.a)(b,2),O=h[0],p=h[1],f=Object(s.useState)(0),x=Object(D.a)(f,2),v=x[0],m=x[1];return Object(a.jsxs)("div",{style:{fontSize:o,height:n,overflow:"hidden"},ref:i,onClick:function(e){var n=e.currentTarget.getBoundingClientRect();console.log(e),console.log(n),console.log(e.pageX);var c=(e.pageX-n.left)/(n.right-n.left);console.log(c);var a=1/t.duration,s=Math.floor(c/a);console.log(s),(e.target===i.current||e.target instanceof Node&&i.current.contains(e.target))&&(p(r[t.time_index+s]),m(t.time_index+s),u(!0))},children:[Object(a.jsx)("div",{style:{textAlign:"left"},children:t.subject}),Object(a.jsx)("div",{style:{textAlign:"center"},children:t.teacher}),Object(a.jsx)("div",{style:{textAlign:"right"},children:t.classroom}),Object(a.jsx)(P,{lessons:O,lessonNumber:v,onClose:function(){u(!1)},open:j})]})},z=n(165);function q(e,t){var n=Array(11).fill(0);console.log(t);for(var r=0;r<11;++r)n[r]=t[r].length;console.log(n);var c,a=_(n.filter((function(e){return 0!=e}))),s=e.map((function(e){var t=e.map((function(e){return{lesson:e}}));return t.sort((function(e,t){var n=e.lesson.time_index+e.lesson.duration-1,r=t.lesson.time_index+t.lesson.duration-1;return n==r?e.lesson.subject.localeCompare(t.lesson.subject):n>r?-1:1})),{lessons:t,totalWidth:a,reamainingWidth:a}})),o=Array(11).fill(a),i=Object(w.a)(s);try{for(i.s();!(c=i.n()).done;){var l,d=c.value,j=Object(w.a)(d.lessons);try{for(j.s();!(l=j.n()).done;){var u=l.value,b=u.lesson.time_index,h=u.lesson.time_index+u.lesson.duration,O=Math.max.apply(Math,Object(A.a)(n.slice(b,h))),p=Math.floor(o[b]/O);u.positionData={width:p};for(var f=b;f<h;++f)n[f]--,o[f]-=p}}catch(x){j.e(x)}finally{j.f()}}}catch(x){i.e(x)}finally{i.f()}return s}var J=function(e){var t=e.dayTimetable,n=e.dayIdx,r=e.currentWeekInterval;if(!t)return Object(a.jsx)("div",{});var c=function(e){var t=Object(A.a)(Array(11)).map((function(){return Array()}));return e.flat().map((function(e){for(var n=0;n<e.duration;n++)t[e.time_index+n].push(e)})),t}(t),s=q(t,c),o=s.length>0?s[0].totalWidth:1;console.log(s);var i=Array(11).fill(o+1),l=s.map((function(e){var t,n=[],r=Object(w.a)(e.lessons);try{for(r.s();!(t=r.n()).done;){var s=t.value,l=i[s.lesson.time_index];n.push(Object(a.jsx)("div",{style:{backgroundColor:"".concat(s.lesson.color),gridRow:"".concat((l-s.positionData.width).toString()," / ").concat(l.toString()),gridColumn:"".concat((s.lesson.time_index+1).toString()," / ").concat((s.lesson.time_index+s.lesson.duration+1).toString())},children:Object(a.jsx)(U,{lesson:s.lesson,height:15*s.positionData.width/o+"vh",lessonsByHour:c})}));for(var d=s.lesson.time_index;d<s.lesson.time_index+s.lesson.duration;++d)i[d]-=s.positionData.width}}catch(j){r.e(j)}finally{r.f()}return n}));return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{children:Object(C.a)(r[n],"iiii",{locale:z.a})}),Object(a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(11, calc(90vw/11))",columnGap:"1px",gridTemplateRows:"repeat(".concat(o,", calc(15vh/").concat(o,"))")},children:l.flat()})]})},X=n(153),Q=function(){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{}),Object(a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(11, calc(90vw/11))",columnGap:"1px"},children:["7:10","8:00","9:00","10:00","11:00","12:00","13:00","14:00","14:50","15:40","16:30"].map((function(e){var t=e.split(":");return(new Date).setHours(parseInt(t[0]),parseInt(t[1]))})).map((function(e,t){return Object(a.jsxs)(f.a,{children:[Object(a.jsx)("div",{children:t.toString()}),Object(a.jsx)("div",{children:Object(C.a)(e,"k:mm")+"-"+Object(C.a)(Object(X.a)(e,45),"k:mm")})]})}))})]})},Y={loadSchedule:S.request},Z=Object(u.a)((function(e){return{timetableWrapper:{display:"grid",gridAutoFlow:"rows",gridTemplateColumns:"7vw 90vw",gridTemplateRows:"5vh repeat(5, 15vh)",rowGap:"1px",margin:e.spacing(2,1,2,1)}}})),K=Object(g.b)((function(e){return{schedule:e.schedule.schedule}}),Y)((function(e){var t=e.schedule,n=e.loadSchedule;console.log("Am I even here?");var r=Object(j.f)().classParam;console.log(r),Object(s.useEffect)((function(){n(r)}),[n,r]);var c=Z(),o=new Date,i=Object(x.a)({start:Object(v.a)(o,{weekStartsOn:1}),end:Object(m.a)(o,{weekStartsOn:1})});return Object(a.jsxs)(f.a,{className:c.timetableWrapper,children:[Object(a.jsx)(Q,{}),Array.from(Array(5).keys()).map((function(e){return Object(a.jsx)(J,{dayTimetable:t[e],dayIdx:e,currentWeekInterval:i})}))]})}));function V(){return Object(a.jsx)(d.a,{basename:"/",children:Object(a.jsxs)(j.c,{children:[Object(a.jsx)(j.a,{path:"/about",children:Object(a.jsx)(ee,{})}),Object(a.jsx)(j.a,{path:"/topics",children:Object(a.jsx)(te,{})}),Object(a.jsxs)(j.a,{path:"/schedule/:classParam",children:[Object(a.jsx)(p,{}),Object(a.jsx)(K,{})]}),Object(a.jsx)(j.a,{path:"/",children:Object(a.jsx)($,{})})]})})}function $(){return Object(a.jsxs)("h2",{children:["Home basename",Object(a.jsx)(d.b,{to:"/schedule/2E",children:"Schedule"})]})}var ee=function(){return Object(a.jsx)("h2",{children:"About"})};function te(){var e=Object(j.g)();return Object(a.jsxs)("div",{children:[Object(a.jsx)("h2",{children:"Topics"}),Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{children:Object(a.jsx)(d.b,{to:"".concat(e.url,"/components"),children:"Components"})}),Object(a.jsx)("li",{children:Object(a.jsx)(d.b,{to:"".concat(e.url,"/props-v-state"),children:"Props v. State"})})]}),Object(a.jsxs)(j.c,{children:[Object(a.jsx)(j.a,{path:"".concat(e.path,"/:topicId"),children:Object(a.jsx)(ne,{})}),Object(a.jsx)(j.a,{path:e.path,children:Object(a.jsx)("h3",{children:"Please select a topic."})})]})]})}function ne(){var e=Object(j.f)().topicId;return Object(a.jsxs)("h3",{children:["Requested topic ID: ",e]})}var re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,169)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))},ce=n(29),ae=n(161),se=Object(y.createReducer)({loading:!0,error:!1}).handleAction(S.request,(function(){return{loading:!0,error:!1}})).handleAction(S.failure,(function(){return{loading:!1,error:!0}})).handleAction(S.success,(function(e,t){return{loading:!1,error:!t.payload.success}})),oe=Object(y.createReducer)([]).handleAction(S.success,(function(e,t){return t.payload.resp?t.payload.resp:[]})),ie=Object(ce.combineReducers)({isLoadingSchedule:se,schedule:oe}),le=Object(ce.combineReducers)({schedule:ie}),de=n(166),je=n(80),ue=n(98),be=n(157),he=n(158),Oe=n(76),pe=n(159),fe=function(e,t,n){var r=n.api;return e.pipe(Object(be.a)(Object(y.isActionOf)(S.request)),Object(he.a)((function(e){return Object(je.a)(r.schedule.getSchedule(e.payload)).pipe(Object(Oe.a)(S.success),Object(pe.a)((function(e){return Object(ue.a)(S.failure(e))})))})))},xe=de.a.apply(void 0,Object(A.a)(Object.values(r)));function ve(e){return fetch("https://sabat.dev/api/tta?c=".concat(e,"&o=0")).then((function(e){return e.json()}))}var me={api:{schedule:c}},ge=n(100),ye=Object(ae.a)({dependencies:me}),Se=[ye],we=Object(ge.composeWithDevTools)(ce.applyMiddleware.apply(void 0,Se)),Ae=Object(ce.createStore)(le,we);ye.run(xe);var Ce=Ae,ke=n(101),_e=n(160),De=Object(ke.a)({overrides:{MuiCssBaseline:{"@global":{"*":{"--scrollbarBG":"#CFD8DC","--thumbBG":"#90A4AE",scrollbarWidth:"thin",scrollbarColor:"var(--thumbBG) var(--scrollbarBG)"},"*::-webkit-scrollbar":{width:"11px"},"*::-webkit-scrollbar-track":{background:"var(--scrollbarBG)"},"*::-webkit-scrollbar-thumb":{backgroundColor:"var(--thumbBG)",bordeRadius:"6px",border:"3px solid var(--scrollbarBG)"}}}}});l.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(g.a,{store:Ce,children:Object(a.jsx)(_e.a,{theme:De,children:Object(a.jsx)(V,{})})})}),document.getElementById("root")),re()}},[[123,1,2]]]);
//# sourceMappingURL=main.86c4d387.chunk.js.map