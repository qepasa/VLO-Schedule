(this["webpackJsonpvlo-schedule"]=this["webpackJsonpvlo-schedule"]||[]).push([[0],{108:function(e,t,n){},115:function(e,t,n){"use strict";n.r(t);var c={};n.r(c),n.d(c,"loadScheduleEpic",(function(){return de}));var r={};n.r(r),n.d(r,"getSchedule",(function(){return ue}));var s=n(2),a=n(0),o=n.n(a),i=n(14),l=n.n(i),d=(n(108),n(46)),j=n(13),u=n(140),h=n(150),b=n(141),O=n(142),p=n(143),f=n(71),x=n(39),v=Object(x.createAsyncAction)("LOAD_SCHEDULE_REQUEST","LOAD_SCHEDULE_SUCCESS","LOAD_SCHEDULE_FAILURE")(),g=n(75),m=n(53),y=n(147);function S(e,t){return t>e?S(t,e):0==t?e:S(t,e%t)}function A(e){if(0==e.length)throw Error("You need to pass at least one number!");if(1==e.length)return e[0];if(2==e.length)return e[0]*e[1]/S(e[0],e[1]);var t=e.pop(),n=A(e);return t*n/S(t,n)}var w=n(82),C=n(86),E=n.n(C),_=n(149),D=n(133),k=n(134),I=n(135),T=n(152),L=n(136),R=n(137),F=n(138),W=function(e){var t=e.lessons,n=e.onClose,c=e.open,r=function(){n()};return Object(s.jsxs)(_.a,{onClose:r,"aria-labelledby":"lessons-list-dialog",open:c,children:[Object(s.jsx)(D.a,{id:"lessons-list-dialog-title",children:"Lekcja"}),Object(s.jsx)(k.a,{children:Object(s.jsx)(I.a,{children:t.map((function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(T.a,{children:Object(s.jsx)(L.a,{primary:"Nazwa lekcji: ".concat(e.subject),secondary:Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{children:["Nauczyciel: ",e.teacher]}),Object(s.jsxs)("div",{children:["Sala: ",e.classroom]})]})})},e.subject+e.teacher+e.color)})}))})}),Object(s.jsx)(R.a,{children:Object(s.jsx)(F.a,{onClick:r,color:"primary",children:"Zamknij"})})]})},H=function(e){var t=e.lesson,n=e.height,c=e.lessonsByHour,r=E()(),o=r.fontSize,i=r.ref,l=Object(a.useState)(!1),d=Object(w.a)(l,2),j=d[0],u=d[1],h=Object(a.useState)([]),b=Object(w.a)(h,2),O=b[0],p=b[1];return Object(s.jsxs)("div",{style:{fontSize:o,height:n,overflow:"hidden"},ref:i,onClick:function(e){var n=e.currentTarget.getBoundingClientRect();console.log(e),console.log(n),console.log(e.pageX);var r=(e.pageX-n.left)/(n.right-n.left);console.log(r);var s=1/t.duration,a=Math.floor(r/s);console.log(a),(e.target===i.current||e.target instanceof Node&&i.current.contains(e.target))&&(p(c[t.time_index+a]),u(!0))},children:[Object(s.jsx)("div",{style:{textAlign:"left"},children:t.subject}),Object(s.jsx)("div",{style:{textAlign:"center"},children:t.teacher}),Object(s.jsx)("div",{style:{textAlign:"right"},children:t.classroom}),Object(s.jsx)(W,{lessons:O,onClose:function(){u(!1)},open:j})]})};function M(e,t){var n=Array(11).fill(0);console.log(t);for(var c=0;c<11;++c)n[c]=t[c].length;console.log(n);var r,s=A(n.filter((function(e){return 0!=e}))),a=e.map((function(e){var t=e.map((function(e){return{lesson:e}}));return t.sort((function(e,t){var n=e.lesson.time_index+e.lesson.duration-1,c=t.lesson.time_index+t.lesson.duration-1;return n==c?e.lesson.subject.localeCompare(t.lesson.subject):n>c?-1:1})),{lessons:t,totalWidth:s,reamainingWidth:s}})),o=Array(11).fill(s),i=Object(g.a)(a);try{for(i.s();!(r=i.n()).done;){var l,d=r.value,j=Object(g.a)(d.lessons);try{for(j.s();!(l=j.n()).done;){var u=l.value,h=u.lesson.time_index,b=u.lesson.time_index+u.lesson.duration,O=Math.max.apply(Math,Object(m.a)(n.slice(h,b))),p=Math.floor(o[h]/O);u.positionData={width:p};for(var f=h;f<b;++f)n[f]--,o[f]-=p}}catch(x){j.e(x)}finally{j.f()}}}catch(x){i.e(x)}finally{i.f()}return a}var P=function(e){var t=e.dayTimetable,n=e.dayIdx,c=e.currentWeekInterval;if(!t)return Object(s.jsx)("div",{});var r=function(e){var t=Object(m.a)(Array(11)).map((function(){return Array()}));return e.flat().map((function(e){for(var n=0;n<e.duration;n++)t[e.time_index+n].push(e)})),t}(t),a=M(t,r),o=a.length>0?a[0].totalWidth:1;console.log(a);var i=Array(11).fill(o+1),l=a.map((function(e){var t,n=[],c=Object(g.a)(e.lessons);try{for(c.s();!(t=c.n()).done;){var a=t.value,l=i[a.lesson.time_index];n.push(Object(s.jsx)("div",{style:{backgroundColor:"".concat(a.lesson.color),gridRow:"".concat((l-a.positionData.width).toString()," / ").concat(l.toString()),gridColumn:"".concat((a.lesson.time_index+1).toString()," / ").concat((a.lesson.time_index+a.lesson.duration+1).toString())},children:Object(s.jsx)(H,{lesson:a.lesson,height:15*a.positionData.width/o+"vh",lessonsByHour:r})}));for(var d=a.lesson.time_index;d<a.lesson.time_index+a.lesson.duration;++d)i[d]-=a.positionData.width}}catch(j){c.e(j)}finally{c.f()}return n}));return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{children:Object(y.a)(c[n],"EEEE")}),Object(s.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(11, calc(80vw/11))",columnGap:"1px",gridTemplateRows:"repeat(".concat(o,", calc(15vh/").concat(o,"))")},children:l.flat()})]})},U=n(139),z=function(){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{children:"Dzie\u0144"}),Object(s.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(11, calc(80vw/11))"},children:["7:10","8:00","9:00","10:00","11:00","12:00","13:00","14:00","14:50","15:40","16:30"].map((function(e){var t=e.split(":");return(new Date).setHours(parseInt(t[0]),parseInt(t[1]))})).map((function(e,t){return Object(s.jsxs)(h.a,{children:[Object(s.jsx)("div",{children:t.toString()}),Object(s.jsx)("div",{children:Object(y.a)(e,"k:mm")+"-"+Object(y.a)(Object(U.a)(e,45),"k:mm")})]})}))})]})},B={loadSchedule:v.request},q=Object(u.a)((function(e){return{timetableWrapper:{display:"grid",gridAutoFlow:"rows",gridTemplateColumns:"10vw 80vw",gridTemplateRows:"repeat(6, 15vh)"}}})),N=Object(f.b)((function(e){return{schedule:e.schedule.schedule}}),B)((function(e){var t=e.schedule,n=e.loadSchedule;console.log("Am I even here?");var c=Object(j.f)().classParam;console.log(c),Object(a.useEffect)((function(){n(c)}),[n,c]);var r=q(),o=new Date,i=Object(b.a)({start:Object(O.a)(o,{weekStartsOn:1}),end:Object(p.a)(o,{weekStartsOn:1})});return Object(s.jsxs)(h.a,{className:r.timetableWrapper,children:[Object(s.jsx)(z,{}),Array.from(Array(5).keys()).map((function(e){return Object(s.jsx)(P,{dayTimetable:t[e],dayIdx:e,currentWeekInterval:i})}))]})}));function J(){return Object(s.jsx)(d.a,{children:Object(s.jsxs)("div",{children:[Object(s.jsx)("ul",{children:Object(s.jsx)("li",{children:Object(s.jsx)(d.b,{to:"/schedule",children:"Schedule"})})}),Object(s.jsxs)(j.c,{children:[Object(s.jsx)(j.a,{path:"/about",children:Object(s.jsx)(G,{})}),Object(s.jsx)(j.a,{path:"/topics",children:Object(s.jsx)(Q,{})}),Object(s.jsx)(j.a,{path:"/schedule/:classParam",children:Object(s.jsx)(N,{})}),Object(s.jsx)(j.a,{path:"/",children:Object(s.jsx)(X,{})})]})]})})}function X(){return Object(s.jsx)("h2",{children:"Home"})}var G=function(){return Object(s.jsx)("h2",{children:"About"})};function Q(){var e=Object(j.g)();return Object(s.jsxs)("div",{children:[Object(s.jsx)("h2",{children:"Topics"}),Object(s.jsxs)("ul",{children:[Object(s.jsx)("li",{children:Object(s.jsx)(d.b,{to:"".concat(e.url,"/components"),children:"Components"})}),Object(s.jsx)("li",{children:Object(s.jsx)(d.b,{to:"".concat(e.url,"/props-v-state"),children:"Props v. State"})})]}),Object(s.jsxs)(j.c,{children:[Object(s.jsx)(j.a,{path:"".concat(e.path,"/:topicId"),children:Object(s.jsx)(Y,{})}),Object(s.jsx)(j.a,{path:e.path,children:Object(s.jsx)("h3",{children:"Please select a topic."})})]})]})}function Y(){var e=Object(j.f)().topicId;return Object(s.jsxs)("h3",{children:["Requested topic ID: ",e]})}var Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,155)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),s(e),a(e)}))},K=n(27),V=n(148),$=Object(x.createReducer)({loading:!0,error:!1}).handleAction(v.request,(function(){return{loading:!0,error:!1}})).handleAction(v.failure,(function(){return{loading:!1,error:!0}})).handleAction(v.success,(function(e,t){return{loading:!1,error:!t.payload.success}})),ee=Object(x.createReducer)([]).handleAction(v.success,(function(e,t){return t.payload.resp?t.payload.resp:[]})),te=Object(K.combineReducers)({isLoadingSchedule:$,schedule:ee}),ne=Object(K.combineReducers)({schedule:te}),ce=n(151),re=n(72),se=n(90),ae=n(144),oe=n(145),ie=n(68),le=n(146),de=function(e,t,n){var c=n.api;return e.pipe(Object(ae.a)(Object(x.isActionOf)(v.request)),Object(oe.a)((function(e){return Object(re.a)(c.schedule.getSchedule(e.payload)).pipe(Object(ie.a)(v.success),Object(le.a)((function(e){return Object(se.a)(v.failure(e))})))})))},je=ce.a.apply(void 0,Object(m.a)(Object.values(c)));function ue(e){return fetch("/api/timetable?class=".concat(e)).then((function(e){return e.json()}))}var he={api:{schedule:r}},be=n(92),Oe=Object(V.a)({dependencies:he}),pe=[Oe],fe=Object(be.composeWithDevTools)(K.applyMiddleware.apply(void 0,pe)),xe=Object(K.createStore)(ne,fe);Oe.run(je);var ve=xe;l.a.render(Object(s.jsx)(o.a.StrictMode,{children:Object(s.jsx)(f.a,{store:ve,children:Object(s.jsx)(J,{})})}),document.getElementById("root")),Z()}},[[115,1,2]]]);
//# sourceMappingURL=main.c2776adc.chunk.js.map